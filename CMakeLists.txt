cmake_minimum_required(VERSION 2.8)
project(VigorTLS)

include(CTest)

if(CMAKE_COMPILER_IS_GNUCXX OR "${CMAKE_CXX_COMPILER_ID}" STREQUAL "Clang")
	set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -Wall -Werror -ggdb -std=gnu99")
else()
	message(FATAL_ERROR "Unsupported compiler:" ${CMAKE_C_COMPILER})
endif()

if (${CMAKE_SYSTEM_PROCESSOR} STREQUAL "x86_64")
	set(ARCH "x86_64")
elseif (${CMAKE_SYSTEM_PROCESSOR} STREQUAL "x86")
	set(ARCH "x86")
else()
	message(FATAL_ERROR "Unsupported processor:" ${CMAKE_SYSTEM_PROCESSOR})
endif()

add_definitions(
	-DOPENSSL_NO_CAMELLIA
	-DOPENSSL_NO_EC_NISTP_64_GCC_128
	-DOPENSSL_NO_CMS
	-DOPENSSL_NO_COMP
	-DOPENSSL_NO_GMP
	-DOPENSSL_NO_GOST
	-DOPENSSL_NO_JPAKE
	-DOPENSSL_NO_KRB5
	-DOPENSSL_NO_MD2
#	-DOPENSSL_NO_PSK
	-DOPENSSL_NO_RC5
	-DOPENSSL_NO_RFC3779
	-DOPENSSL_NO_SCTP
	-DOPENSSL_NO_SEED
	-DOPENSSL_NO_SRP
	-DOPENSSL_NO_SSL2
	-DOPENSSL_NO_STORE
	-DOPENSSL_NO_BUF_FREELISTS
	-DOPENSSL_NO_HEARTBEATS
	-DOPENSSL_NO_DYNAMIC_ENGINE

	-DOPENSSL_THREADS
)

add_subdirectory(crypto)
add_subdirectory(ssl)
add_subdirectory(apps)
add_subdirectory(tests)
